var DEMO=function(e,t){"use strict";var n=e("#grid"),r=n.find(".picture-item"),i=n.find(".shuffle__sizer"),s=e("#portfolio-filter li a"),o,u=function(){n.shuffle({itemSelector:".picture-item",sizer:i});o=n.data("shuffle");a();setTimeout(function(){c();f();h()},100)},a=function(){r.each(function(){t.add({element:this,threshold:130,enter:l})})},f=function(){r.find(".picture-wrapper").addClass("picture-wrapper--transition")},l=function(){e(this).addClass("in")},c=function(){var r=e.throttle(300,function(){n.shuffle("update");t.refresh()}),i=n.find("img");i.each(function(){var t;if(this.complete&&this.naturalWidth!==undefined)return;t=new Image;e(t).on("load",function(){e(this).off("load");r()});t.src=this.src});setTimeout(function(){r()},500)},h=function(){s.on("click",function(){var t=e(this),i=t.parent().hasClass("active"),s=i?"all":t.data("group");i||e("#portfolio-filter .active").removeClass("active");t.parent().toggleClass("active");n.shuffle("shuffle",s);r.find(".picture-wrapper").addClass("picture-wrapper--transition");r.each(function(){e(this).addClass("in")})});s=null};return{init:u,getShuffle:function(){return o}}}(jQuery,window.Viewport);$(document).ready(function(){DEMO.init()});